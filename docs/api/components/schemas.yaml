# ----------------------------------------------------------------------
# ---------------------------- Règlements ------------------------------
# ----------------------------------------------------------------------

entete_reglement:
  allOf:
    - $ref: '#/nouvel_entete_reglement'
    - type: object
      properties:
        id_reg_stat:
          type: integer
          description: identifiant unique du règlement
      required:
        - id_reg_stat
  examples:
    full:
      id_reg_stat: 176
      description: 'Logement'
      annee_debut_reg: 1995
      annee_fin_reg: 1997
      texte_loi: 'VQZ 3'
      article_loi: 'Annexe D'
      paragraphe_loi: '10.a'
      ville: 'Québec'
nouvel_entete_reglement:
  type: object
  properties:
    description:
      type: string
      description: Description sommaire du règlement
    annee_debut_reg:
      type: string
      description: Année d'entrée en vigueur du règlement
      nullable: true
    annee_fin_reg:
      type: string
      description: Année d'abrogation du règlement
      nullable: true
    texte_loi:
      type: string
      description: Texte de loi dont provient le règlement
    article_loi:
      type: string
      description: Article de loi dont provient le règlement
      nullable: true
    paragraphe_loi:
      type: string
      description: Paragraphe de la loi dont provient le règlement
      nullable: true
    ville:
      type: string
      description: Ville dans laquelle le règlement s'applique
  required:
    - description
    - annee_debut_reg
    - annee_fin_reg
    - texte_loi
    - article_loi
    - paragraphe_loi
    - ville
  examples:
    full:
      description: 'Logement'
      annee_debut_reg: 1995
      annee_fin_reg: 1997
      texte_loi: 'VQZ 3'
      article_loi: 'Annexe D'
      paragraphe_loi: '10.a'
      ville: 'Québec'
nouvelle_definition_reglement:
  type: object
  properties:
    id_reg_stat:
      type: integer
      description: Identifiant de règlement parent
    ss_ensemble:
      type: integer
      description: Identifiant de sous-ensemble
    oper:
      type: integer
      description: Identiant d,opération
      nullable: true
    seuil:
      type: number
      description: seuil
    pente_min:
      type: number
      description: Pente de la courbe linéaire du nombre de places minimums par unite
      nullable: true
    pente_max:
      type: number
      description: >-
        Pente de la courbe lineaire du nombre de places maximum en
        fonctionde l'unité donnée
      nullable: true
    cases_fix_min:
      type: number
      description: >-
        Ordonnée à l'origine de la courbe linéaire du nombre de places
        minimum en fonction de l'unité
    cases_fix_max:
      type: number
      description: >-
        Ordonnée à l'origine de la courbe linéaire du nombre de places
        maximum en fonction de l'unité
    unite:
      type: integer
      description: Unité de formulation de la ligne
  required:
    - id_reg_stat
    - oper
    - seuil
    - pente_min
    - pente_max
    - cases_fix_min
    - cases_fix_max
    - unite
    - ss_ensemble
  examples:
    OneSpotPerTwentySquareMeter:
      id_reg_stat: 176
      ss_ensemble: 1
      oper: null
      seuil: 0
      pente_min: 0.05
      pente_max: null
      cases_fix_min: 0
      cases_fix_max: null
      unite: 4 
definition_reglement:
  allOf:
    - $ref: '#/nouvelle_definition_reglement'
    - type: object
      properties:
        id_reg_stat_emp:
          type: integer
          description: identifiant unique de la ligne de définition de règlement
  examples:
    OneSpotPerTwentySquareMeter:
      id_reg_stat: 176
      ss_ensemble: 1
      oper: null
      seuil: 0
      pente_min: 0.05
      pente_max: null
      cases_fix_min: 0
      cases_fix_max: null
      unite: 4
reglement:
  type: object
  properties:
    entete:
      $ref: '#/entete_reglement'
    definition:
      type: array
      items:
        $ref: '#/definition_reglement'
  required:
    - entete
    - definition
  examples:
    fullExample:
      entete:
        $ref: '#/entete_reglement/examples/full'
      definition:
        $ref: '#/definition_reglement/examples/OneSpotPerTwentySquareMeter'
unite:
  type: object
  properties:
    id_unite:
      type: integer
      description: Identifiant de l'unité
    colonne_role_foncier:
      type: string
      description: |
        Colonne du rôle foncier à utilise en intrant de la conversion
    facteur_correction:
      type: number
      description: Pente de la droite liant l'unité id_unite à la colonne_role_foncier
    abscisse_correction:
      type: number
      description: >-
        Ordonnée à l'origine de la droite liant l'unité id_unite à la
        colonne_role_foncier
    desc_unite:
      type: string
      description: Description de l'unité
  required:
    - id_unite
    - colonne_role_foncier
    - facteur_correction
    - abscisse_correction
    - desc_unite
operation_reglement:
  type: object
  properties:
    id_operation:
      type: integer
      description: Identifiant de l'opération
    desc_operation:
      type: string
      description: Description de l'opération
  required:
    - id_operation
    - desc_operation


# -----------------------------------------------------------------------
# ------------------------------ Période --------------------------------
# -----------------------------------------------------------------------

nouvelle_periode:
  type: object
  properties:
    nom_periode:
      type: string
      description: Nom de visualisation de la période
    date_debut_periode:
      type: integer
      description: >-
        Date de début de la période. Null: capture toutes les dates avant la
        date de fin
      nullable: true
    date_fin_periode:
      type: integer
      description: 'Date de fin de la période. Null: encore en vigueur'
      nullable: true
  required:
    - nom_periode
    - date_debut_periode
    - date_fin_periode
periode:
  allOf:
    - $ref: '#/nouvelle_periode'
    - properties:
        id_periode:
          type: integer
          description: Identifiant unique de la période

# ------------------------------------------------------------------------
# ------------------------------- Inventaire -----------------------------
# ------------------------------------------------------------------------

inventaire:
  type: object
  properties:
    id_inv:
      type: integer
      description: Identifiant unique
      readOnly: true
    g_no_lot:
      type: string
      description: Identifiant du lot cadastral
    n_places_min:
      type: number
      description: Nombre de places minimum selon le code d'urbanisme
    n_places_max:
      type: number
      description: Nombre de places maxium selon le code d'urbanisme
    n_places_estime:
      type: number
      description: >-
        Nombre de places estimées selon une méthode d'estimation donnée
        autre que par la méthode règlementaire
    n_places_mesure:
      type: integer
      description: Nombre de places recensées manuellement
    methode_estime:
      type: integer
      description: >-
        Méthode estimation: 1 manuel, 2: méthode réglementaire 3: méthode
        réglementaire avec entrées manuelles
    cubf:
      type: string
      description: List des cubf inclus dans le rôle de ce lot
    id_reg_stat:
      type: string
      description: Liste des règlements utilisés pour le calcul
    id_er:
      type: string
      description: Liste des ensembles de règlements utilisés pour le calcul
    commentaire:
      type: string
      description: Commentaire quelconque, souvent auto généré
  required:
    - g_no_lot
    - n_places_min
    - n_places_max
    - n_places_estime
    - n_places_mesure
    - methode_estime
    - cubf
    - id_reg_stat
    - id_er
    - commentaire
  examples: 
    fullExempleLogement:
      id_inv: 1
      n_places_min: 1
      n_places_max: 2
      n_places_estime: null
      n_places_mesure: null
      methode_estime: 2
      cubf: '1000'
      id_reg_stat: '50'
      id_er: '70'
      commentaire: 'Unite: 2 Val: 1'

# ------------------------------------------------------------------------
# -------------------------------- Lot cadastral -------------------------
# ------------------------------------------------------------------------

lot_cadastral:
  type: object
  properties:
    g_no_lot:
      type: string
      description: Identifiant cadastral
    g_va_suprf:
      type: number
      description: Superficie du lot cadastral
    g_nb_coord:
      type: number
      description: Longitude du centroide du lot
    g_nb_coo_1:
      type: number
      description: Latitude du centroide du lot
    geometry:
      $ref: '#/Geometry'
      description: Polygone représentant le lot
  required:
    - g_no_lot
    - g_va_suprf
    - g_nb_coord
    - g_nb_coo_1
    - geometry
# ------------------------------------------------------------------------
# -------------------------------- Quartiers analyse ---------------------
# ------------------------------------------------------------------------

quartier_analyse:
  type: object
  properties:
    id_quartier:
      type: integer
      description: Idenifant de quartier
    nom_quartier:
      type: string
      description: Nom complet de quartier
    acro:
      type: string
      description: Acronyme de quartier
    superf_quartier:
      type: number
      description: Superficie du quartier en mètres carrés
    geometry:
      $ref: '#/Geometry'
      description: Géométrie du quartier
  required:
    - id_quartier
    - nom_quartier
    - acro
    - superf_quartier
    - geometry
# -------------------------------------------------------------------------
# ------------------------ Territoire géopolitique ------------------------
# -------------------------------------------------------------------------

territoire:
  type: object
  properties:
    id_periode_geo:
      type: integer
      description: Identifiant unique du territoire
    ville:
      type: string
      description: Nom de la ville
    secteur:
      type: string
      description: Description de secteur
    ville_sec:
      type: string
      description: Concaténation de ville et secteur pour visualisation
    id_periode:
      type: integer
      description: Référence à la période où ce territoire est valide
    geometry:
      $ref: '#/Geometry'
      description: Polygone représentant le territoire
  required:
    - id_periode_geo
    - ville
    - secteur
    - ville_sec
    - id_periode
    - geometry
# -------------------------------------------------------------------------
# ------------------------ Données foncières ------------------------------
# -------------------------------------------------------------------------

role_foncier:
  type: object
  properties:
    id_provinc:
      type: string
      description: Identifiant unique pour chaque entrée du rôle foncier
    code_mun:
      type: string
      description: Code de 5 chiffres affecté à chaque municipalité du québec
    arrond:
      type: string
      description: Arrondissement dans lequel se trouve l'entrée du rôle
    anrole:
      type: string
      description: Année du rôle foncier
    rl0105a:
      type: integer
      description: Code d'Utilisation du Bien Fonds pour la propriété
      minimum: 1000
      maximum: 9999
    rl0302a:
      type: number
      description: Superficie terrain en mètres carrés
    rl0308a:
      type: number
      description: Superficie d'étages en mètres carré
    rl0306a:
      type: integer
      description: Nombre d'étages du bâtiment principal
    rl0311a:
      type: integer
      description: Nombre de logements dans l'unité d'évaluation
    rl0312a:
      type: integer
      description: Nombre de chambres locatives dans l'unité d'évaluation
    rl0313a:
      type: integer
      description: Nombre de locaux non résidentiels de l'unité d'évaluation
    rl0402a:
      type: integer
      description: Valeur attribuable au terrain
    rl0403a:
      type: integer
      description: Valeur attribuable au bâtiments
    rl0404a:
      type: integer
      description: Valeur du terrain et des bâtiments
    rl0405a:
      type: integer
      description: Valeur du terrain et du bâtiment au rôle précédent
    geometry:
      allOf:
        - $ref: '#/Geometry'
        - description: Point associé à l'entrée du rôle foncier
        - properties:
            type: 
              enum: Point
            coordinates:
              type: array
              items:
                type: number
              minItems: 2

  required:
    - id_provinc
    - code_mun
    - arrond
    - anrole
    - rl0105a
    - rl0302a
    - rl0308a
    - rl0306a
    - rl0311a
    - rl0312a
    - rl0313a
    - rl0402a
    - rl0403a
    - rl0404a
    - rl0405a
# -------------------------------------------------------------------------
# ----------------------- Intrants calcul semi-automatique ----------------
# -------------------------------------------------------------------------
entree_calcul_inventaire:
  type: object
  properties:
    g_no_lot:
      type: string
      description: Identifant de lot cadastral
    cubf:
      type: integer
      description: Code d'utilisation du bien fonds
    id_reg_stat:
      type: integer
      description: Identifiant du règlement de stationnement à utiliser pour le calcul
    id_er:
      type: integer
      description: Identifiant de l'ensemble de règlements
    unite:
      type: integer
      description: Identifiant de l'unité
    valeur:
      type: number
      description: >-
        Valeur de l'unité spécifié pour le calcul des  minimums du lot
        spécifié avec le règleement spécifié
  required:
    - g_no_lot
    - cubf
    - id_reg_stat
    - valeur
    - id_er
    - unite
# -------------------------------------------------------------------------
# ----------------------- Code d'utilisation du sol -----------------------
# -------------------------------------------------------------------------
utilisation_sol:
  type: object
  properties:
    cubf: 
      type: integer
      description: identifiant de l'utilisation du sol
    description:
      type: string
      description: description de l'utilsation du sol
  required:
    - cubf
    - description

liste_n_cubf:
  type: object
  properties: 
    niveau:
      type: integer
      description: Chiffre de 1 à 4
    description: 
      type: string
      description: Description des cubf
    n_entrees:
      type: integer
      description: Nombre d'entrées à ce niveau
# -------------------------------------------------------------------------
# ----------------------- Ensembles de règlements -------------------------
# -------------------------------------------------------------------------

nouvel_entete_ensemble_reglement:
  type: object
  properties: 
    date_debut_er:
      type: integer
      description: Année d'entrée en vigueur de l'ensemble de règlements
    date_fin_er:
      type: integer
      description: Année d'abrogation de l'ensemble de règlements
    description_er:
      type: string
      description: Description sommaire de l'ensemble de règlements
  required:
    - date_debut_er
    - date_fin_er
    - description_er
entete_ensemble_reglement:
  allOf:
    - $ref: '#/nouvel_entete_ensemble_reglement'
    - properties: 
        id_er: 
          type: integer
          description: Identifiant de l'ensemble de règlements
      required:
        - id_er
nouvelle_association_cubf_er:
  type: object
  properties:
    id_reg_stat:
      type: integer
      description: Identifiant de règlement 
    cubf: 
      type: integer
      description: code d'utitilisation du bien fonds auquel on veut associer les règlements
    id_er: 
      type: integer
      description: Identifiant de l'ensemble de règlements auquel appartient l'association
  required:
      - id_er
      - cubf
      - id_reg_stat
association_cubf_er:
  allOf:
    - $ref: '#/nouvelle_association_cubf_er'
    - type: object
      properties: 
        id_assoc_er_reg:
          type: integer
          description: identifiant de l'association
  required:
    - id_assoc_er_reg

ensemble_reglement_complet:
  type: object
  properties:
    entete: 
      $ref: '#/entete_ensemble_reglement'
    assoc_util_reg:
      type: array
      description: Affectation des règlements aux codes d'utilisation du bien fonds
      items: 
        $ref: '#/association_cubf_er'
    table_util_sol:
      type: array
      items: 
        $ref: '#/utilisation_sol'
# -------------------------------------------------------------------------
# ----------------- Ensembles de règlements territoires -------------------
# -------------------------------------------------------------------------

association_territoire_ensemble_sans_id:
  type: object
  properties:
    id_er:
      type: integer
      description: Identifiant de l'ensemble de règlements
    id_periode_geo:
      type: integer
      description: Identifiant du territoire

association_territoire_ensemble_avec_id:
  allOf:
    - $ref: '#/association_territoire_ensemble_sans_id'
    - type: object
      properties:
        id_asso_er_ter: 
          type: integer
          description: identifiant unique de l'association

association_territoire_ensemble_avec_infos:
  allOf:
    - $ref: '#/association_territoire_ensemble_avec_id'
    - type: object
      properties:
        description_er:
          type: string
          description: description de l'ensemble de règlements
        date_debut_er:
          type: integer
          nullable: true
          description: date de d'entrée en vigueur de l'ensemble de règlements inclusif
        date_fin_er:
          type: integer
          nullable: true
          description: Date d'abrogation de l'ensemble de règlements


# -------------------------------------------------------------------------
# ------------------------------ GeoJSON ----------------------------------
# -------------------------------------------------------------------------

Geometry:
  type: object
  required:
    - type
    - coordinates
  properties:
    type:
      type: string
      enum:
        - Polygon
        - LineString
        - Point
        - MultiPolygon
    coordinates:
      allOf:
        - type: array # Polygon & LineString
          description: An array of linear rings. Each ring is an array of positions.
          items:
            type: array
            items:
              type: array
              items:
                type: number
              minItems: 2
        - type: array # Point 
          description: A single
          items:
            type: number
          minItems: 2
        - type: array # MultiPolygon
          description: An array of arrays of linear rings. Each ring is an array of positions.
          items:
            type: array
            items:
              type: array
              items:
                type: array
                items:
                  type: number
                minItems: 2
  example:
    type: Polygon
    coordinates:
      - - - -73.6
          - 45.5
        - - -73.7
          - 45.5
        - - -73.7
          - 45.6
        - - -73.6
          - 45.6
        - - -73.6
          - 45.5
# -------------------------------------------------------------------------
# -------------------------- Variable Analyse -----------------------------
# -------------------------------------------------------------------------

var_ana:
  type: string
  enum:
    - stat-tot
    - stat-res
    - stat-ind
    - stat-inf
    - stat-com
    - stat-ser
    - stat-rec
    - stat-agr
    - stat-inex
    - stat-sup
    - stat-popu-2021
    - stat-popu-2016
    - stat-perm
    - stat-voit
    - stat-res-voit
    - stat-perc
    - stat-res-log
    - stat-res-perm
    - stat-inu
    - stat-inu-sup
    - stat-voit-max
    - superf_quartier
    - perm
    - popu-2021
    - popu-2016
    - voit-par-pers-2016
    - voit-par-pers-2021
    - voit-par-perm
    - dens-pop-2021
    - dens-pop-2016
    - val-log-moy
    - sup-log-moy
    - val-tot-quart
    - val-tot-log-quart
    - val-tot-sup
    - val-tot-log-sup
    - nb-voit
    - nb-voit-delta
    - nb-voit-max
    - nb-voit-min
    - pm-ac-res
    - pm-ap-res
    - pm-tc-res
    - pm-mv-res
    - pm-bs-res
    - pm-ac-int
    - pm-ap-int
    - pm-tc-int
    - pm-mv-int
    - pm-bs-int
    - pm-ac-ori
    - pm-ap-ori
    - pm-tc-ori
    - pm-mv-ori
    - pm-bs-ori
    - pm-ac-des
    - pm-ap-des
    - pm-tc-des
    - pm-mv-des
    - pm-bs-des
    - n-logements

ordres_stat_valid:
  type: string
  enum:
    - 1,2,3
    - 1,3,2
    - 2,1,3
    - 2,3,1
    - 3,1,2
    - 3,2,1
    - '1'
    - '2'
    - '3'

ana_carto:
  type: object
  properties:
    id_quartier:
      type: integer
      description: Identifiant quartier
    nom_quartier:
      type: string
      description: Nom du quartier
    superf_quartier:
      type: number
      description: Superficie du quartier en mètres carrés
    description:
      type: string
      description: Description de la Variable
    valeur:
      type: number
      description: Valeur d'intérêt présenté
    geometry:
      description: Géométrie du quartier
      schema: 
        allOf:
          - schema:
            $ref: '#/Geometry'
          - type: 
              type: string
              enum:
                - MultiPolygon
                
ana_histo:
  type: object
  properties: 
    valeurVille:
      description: Valeurs de la variable pour la ville
      type: number
    description:
      description: Description de la variable
      type: string
    donnees:
      type: array
      items:
        type: object
        properties: 
          id_quartier:
            type: string
            description: identifiant de quartier
          nom_quartier:
            type: string
            description: Nom du quartier
          valeurs:
            type: number
            description: valeur de la variable d'intérêt

ana_XY:
  type: object
  properties:
    descriptionX: Description de la variable X
    descriptionY : Description de la variable Y
    donnees:
      type: array
      items:
        type: object
        properties:
          id_quartier: 
            type: integer
            description: Identifiant de quartier
          nom_quartier: 
            type: string
            description: Nom du quartier
          x:
            type: number
            description: valeur de l'abscisse
          y:
            type: number
            description: valeur de l'ordonnée

# -------------------------------------------------------------------------
# --------------- Profile Accumulation Véhicules --------------------------
# -------------------------------------------------------------------------

var_pav:
  type: string
  enum: 
    - voitures
    - personnes
    - permis
    - voitures_res
    - voitures_pub
    - voit_entrantes_tot
    - voit_entrantes_pub
    - voit_entrantes_res
    - voit_sortantes_tot
    - voit_sortantes_pub
    - voit_sortantes_res
    - pers_entrantes_tot
    - pers_sortantes_tot
    - perm_entrants_tot
    - perm_sortants_tot

var_cap_stat:
  type: string
  enum: 
    - res
    - pub
    - tot
    - none


PAV_recalcul_sans_id_quartier: 
  type: object
  properties:
    heure:
      type: integer
      description: Heure pour laquelle l'inventairede voiture est dressé
    voitures:
      type: integer
      description: Nombre de voitures stationnées dans le quartier
    personnes: 
      type: integer
      description: Nombre de personnes dans le quartier
    permis:
      type: integer
      description: Nombre de détenteurs de permis dans le quartier
    voitures_res:
      type: integer
      description: Nombre de voitures stationnées dans des terrains à vocation résidentielle
    voitures_pub:
      type: integer
      description: Nombre de voitures stationnées dans les résidences
    voit_transfer_pub_a_res:
          type: integer
          description: Voitures qui sont transférées de manière interne du public au résidentiel
    voit_transfer_res_a_pub:
      type: integer
      description: Voitures qui sont transférées de manière interne du résidentiel au public
    voit_entrantes_tot:
      type: integer
      description: nombre total de voitures entrant dans le quartier
    voit_entrantes_pub:
      type: integer
      description: Nombre de voitures entrant dans le secteur se stationnant dans un lieu public
    voit_entrantes_res:
      type: integer
      description: Nombre de voitures entrant dans le secteur se stationnant dans une résidence
    voit_sortantes_tot:
      type: integer
      description: Nombre total de voitures sortant du secteur
    voit_sortantes_pub:
      type: integer
      description: Nombre de voitures sortant du secteur en provenance d'un lieu public
    voit_sortantes_res:
      type: integer
      description: NOmbre de voiture sortant du secteur en provenance d'un stationnement résidentiel
    pers_entrantes_tot:
      type: integer
      description: Nombre de personnes entrant dans le secteur
    pers_sortantes_tot:
      type: integer
      description: Nombre de personnes sortant du secteur
    perm_entrants_tot:
      type: integer
      description: Nombre de permis entrant dans le secteur
    perm_sortants_tot:
      type: integer
      description: Nombre de permis sortant du secteur
  

retour_PAV_recalcule:
  allOf:
    - schema:
        $ref: '#/PAV_recalcul_sans_id_quartier'
    - type: object
      properties: 
        id_quartier: 
          type: integer
          description: identifiant du quartier


retour_profile_accumulation_vehicule:
  type: object
  properties:
    id_quartier: 
      type: integer
      description: Identifiant du quartier
    nom_quartier: 
      type: string
      description: Nom du quartier
    capacite_stat_quartier:
      type: integer
      description: capacité de stationnement
    PAV:
      type: array
      items: 
        type: object
        properties: 
          id_ent_pav:
            type: integer
            description: Identifiant unique
          heure:
            type: integer
            description: Heure pour laquelle l'inventairede voiture est dressé
          valeur: 
            type: integer
            description: Valeur qui a été requise par le paramètre type
          voitures:
            type: integer
            description: Nombre de voitures stationnées dans le quartier
          personnes: 
            type: integer
            description: Nombre de personnes dans le quartier
          permis:
            type: integer
            description: Nombre de détenteurs de permis dans le quartier
          voitures_res:
            type: integer
            description: Nombre de voitures stationnées dans des terrains à vocation résidentielle
          voitures_pub:
            type: integer
            description: Nombre de voitures stationnées dans les résidences


retour_PAV_etendu:
  allOf:
    - $ref: '#/retour_profile_accumulation_vehicule'
    - type: object
      properties:
        voit_transfer_pub_a_res:
          type: integer
          description: Voitures qui sont transférées de manière interne du public au résidentiel
        voit_transfer_res_a_pub:
          type: integer
          description: Voitures qui sont transférées de manière interne du résidentiel au public


# -------------------------------------------------------------------------
# --------------------- Analyse de variabilité ----------------------------
# -------------------------------------------------------------------------
boolean_enum:
  type: string
  enum:
    - true
    - false
    - ''

retour_ana_var:
  type: object
  properties: 
    cubf: 
      type: integer
      description: code d'utilisation du biend fonds simplifié (1 à 9)
    id_er:
      type: integer
      description: Identifiant de l'ensemble de règlements
    description_er: 
      type: string
      description: description de l'ensemble de règlemnts
    facteur_echelle:
      type: string
      description: facteur d'échelle utilisé pour l'analyse de variabilité
    desc_cubf:
      type: string
      description: description du code d'utilistion du bien fonds
    valeur:
      type: number
      description: "valeur d'intérêt qu'on essaie de grapher. Peut être un nombre de places brutes ou un ratio"
    
  

# -------------------------------------------------------------------
# --------------------------- Formats réponse -----------------------
# ------------------------------------------------------------------- 

api_response:
  type: object
  properties:
    success:
      type: boolean
      description: Succès ou échec de la requête
    data:
      type: object
      description: Item renvoyé
    message:
      type: string
      description: Message décrivant l'erreur
  required:
    - success
  examples:
    ErreurInterne:
      success: false
      message: Erreur interne de serveur
    ItemIntrouvable:
      success: false
      message: Item non trouvé
# -------------------------------------------------------------------
# ----------------------------- Reponse Règlements ------------------
# -------------------------------------------------------------------
reponse_reglement_ligne_def:
  allOf:
    - $ref: '#/api_response'
    - type: object
      properties:
        data: 
          allOf:
            - $ref: '#/definition_reglement'
            - type: array
              items:
                $ref: '#/definition_reglement'

reponse_entete_array:
  allOf:
    - $ref: '#/api_response'
    - type: object
      properties:
        data:
          oneOf:
            - $ref: '#/entete_reglement'
            - type: array
              items:
                $ref: '#/entete_reglement'
      examples: 
        multiElement:
          success: true
          data: 
            - id_reg_stat: 176
              description: "Logement"
              annee_debut_reg: 1995
              annee_fin_reg: 1997
              texte_loi: "VQZ 3"
              article_loi: "Annexe D"
              paragraphe_loi: "10.a"
              ville: "Québec"
            - id_reg_stat: 177
              description: "Industriel"
              annee_debut_reg: 1995
              annee_fin_reg: 2000
              texte_loi: "VQZ 3"
              article_loi: "Annexe D"
              paragraphe_loi: "5.b"
              ville: "Québec" 

# -------------------------------------------------------------------
# ----------------------------- Reponse Période ---------------------
# -------------------------------------------------------------------
reponse_periode:
  allOf:  
    - $ref: '#/api_response'
    - type: object
      properties:
        data:
          $ref: '#/periode'
# -------------------------------------------------------------------
# ----------------------------- Reponse Ens Règ ---------------------
# -------------------------------------------------------------------
reponse_ens_reg_entete:
  allOf:
    - $ref: '#/api_response'
    - type: object
      properties:
        data:
          oneOf:
            - $ref: '#/entete_ensemble_reglement'
            - type: array
              items:
                $ref: '#/entete_ensemble_reglement'
reponse_ens_reg_complet:
  allOf:
    - $ref: '#/api_response'
    - type: object
      properties:
        data: 
          $ref: '#/ensemble_reglement_complet'
reponse_ens_reg_assoc:
  allOf:
    - $ref: '#/api_response'
    - type: object
      properties: 
        data:
          $ref: '#/association_cubf_er'

# -------------------------------------------------------------------
# -------------------- Reponse Ens Règ Terr -------------------------
# -------------------------------------------------------------------
reponse_ens_reg_terr_sans_desc:
  allOf:
    - $ref: '#/api_response'
    - type: object
      properties: 
        data: 
          type: array
          items: 
            $ref: '#/association_territoire_ensemble_avec_id'
reponse_ens_reg_terr_avec_desc:
   allOf:
    - $ref: '#/api_response'
    - type: object
      properties: 
        data:
          type: array
          items:
            $ref: '#/association_territoire_ensemble_avec_infos'

# -------------------------------------------------------------------
# -------------------- Reponse données foncières --------------------
# -------------------------------------------------------------------

reponse_lot_cadastral:
  allOf:
    - $ref: '#/api_response'
    - type: object
      properties:
        data: 
          allOf:
            - type: array
              items:
                $ref: '#/lot_cadastral'
reponse_role_foncier:
  allOf:
    - $ref: '#/api_response'
    - type: object
      properties:
        data:
          allOf:  
            - type: array
              items: 
                $ref: '#/role_foncier'
# -------------------------------------------------------------------
# -------------------- Reponse utilisation du sol -------------------
# -------------------------------------------------------------------

reponse_cubf:
  allOf:
    - $ref: '#/api_response'
    - type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/utilisation_sol'

reponse_n_cubf:
  allOf:
    - $ref: '#/api_response'
    - type: object
      properties:
        data: 
          type: array
          items:
            $ref: '#/liste_n_cubf'

# -------------------------------------------------------------------
# -------------------- Reponse analyse ------------------------------
# -------------------------------------------------------------------
reponse_ana_carto:
  allOf:
    - $ref: '#/api_response'
    - type: object
      properties:
        data:
          allOf:  
            - type: array
              items: 
                $ref: '#/ana_carto'
reponse_ana_histo:
  allOf:
    - $ref: '#/api_response'
    - type: object
      properties:
        data: 
          schema:
            $ref: '#/ana_histo'
reponse_ana_xy:
  allOf:
    - $ref: '#/api_response'
    - type: object
      properties: 
        data: 
          schema:
            $ref: '#/ana_XY'

# -------------------------------------------------------------------
# -------------------- Réponse analyse variabilité ------------------
# -------------------------------------------------------------------

reponse_ana_var:
  allOf:
    - $ref: '#/api_response'
    - type: object
      properties:
        data: 
          schema:
            $ref: '#/retour_ana_var'

# -------------------------------------------------------------------
# -------------------- Reponse PAV ----------------------------------
# -------------------------------------------------------------------
corps_requete_sauve_pav:
  type: array
  items: 
    schema:
      $ref: '#/PAV_recalcul_sans_id_quartier'

reponse_PAV:
  allOf:
    - $ref: '#/api_response'
    - type: object
      properties:
        data:
          schema:
            $ref: '#/retour_profile_accumulation_vehicule'
reponse_PAV_recalcul:
  allOf:
    - $ref: '#/api_response'
    - type: object
      properties:
        data:
          type: array
          items: 
            schema:
              $ref: '#/retour_PAV_etendu'